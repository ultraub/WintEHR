# ============================================================================
# WintEHR Environment Configuration
# ============================================================================
#
# Copy this file to .env and update with your settings:
#   cp .env.example .env
#
# This is the ONLY .env.example file needed for the project.
# All services (backend, frontend, database) are configured here.
#
# ============================================================================

# ============================================================================
# DEPLOYMENT PROFILE
# ============================================================================
# Controls which docker-compose profile to use
# Options: dev, prod
ENVIRONMENT=dev

# Docker restart policy (no for dev, unless-stopped for prod)
RESTART_POLICY=no

# Domain name for production deployments
# Used for SSL certificates and frontend build URLs
DOMAIN=localhost

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
# PostgreSQL credentials - used by all services

POSTGRES_USER=emr_user
POSTGRES_PASSWORD=emr_password
POSTGRES_DB=emr_db
POSTGRES_PORT=5432

# Full database URL (constructed from above - update if password contains special chars)
DATABASE_URL=postgresql+asyncpg://emr_user:emr_password@postgres:5432/emr_db

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================

REDIS_URL=redis://redis:6379/0
REDIS_PORT=6379
REDIS_MAXMEMORY=256mb

# ============================================================================
# SERVICE PORTS
# ============================================================================
# Customize if default ports conflict with other services

BACKEND_PORT=8000
FRONTEND_PORT=3000
HAPI_FHIR_PORT=8888
HTTP_PORT=80
HTTPS_PORT=443

# ============================================================================
# HAPI FHIR CONFIGURATION
# ============================================================================
# Internal URL (container-to-container)
HAPI_FHIR_URL=http://hapi-fhir:8080/fhir

# Server address for FHIR resource URLs (update for production)
HAPI_FHIR_SERVER_ADDRESS=http://localhost:8080/fhir

# ============================================================================
# BACKEND CONFIGURATION
# ============================================================================

# Security - generate new values for any non-local deployment
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(50))"
SECRET_KEY=dev-secret-key-change-for-production
JWT_SECRET=dev-jwt-secret-change-for-production
JWT_ENABLED=false
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=1440

# Server settings
HOST=0.0.0.0
PORT=8000
DEBUG=true
LOG_LEVEL=INFO

# CORS - comma separated list of allowed origins
CORS_ORIGINS=http://localhost:3000,http://localhost

# ============================================================================
# FRONTEND CONFIGURATION
# ============================================================================
# These are baked into the React build at build time

# API URLs - update for production
REACT_APP_API_URL=http://localhost:8000
REACT_APP_FHIR_ENDPOINT=http://localhost:8000/fhir/R4
REACT_APP_EMR_API=http://localhost:8000/api/emr
REACT_APP_CLINICAL_CANVAS_API=http://localhost:8000/api/clinical-canvas
REACT_APP_WS_URL=ws://localhost:8000/ws

# Feature flags
REACT_APP_EMR_FEATURES=true
REACT_APP_ENABLE_SEARCH=true
REACT_APP_ENABLE_HISTORY=true
REACT_APP_ENABLE_OPERATIONS=true
REACT_APP_ENABLE_BATCH=true

# ============================================================================
# CLINICAL CANVAS / AI FEATURES (Optional)
# ============================================================================
# Uncomment and add your API key to enable AI features

# ANTHROPIC_API_KEY=your-anthropic-api-key-here
# CLAUDE_MODEL=claude-3-opus-20240229
# CLAUDE_TEMPERATURE=0.0

# Feature flags for Clinical Canvas
CLINICAL_CANVAS_ENABLE_CLAUDE_NLP=true
CLINICAL_CANVAS_ENABLE_MULTI_AGENT=true
CLINICAL_CANVAS_ENABLE_CODE_SANDBOX=true
CLINICAL_CANVAS_MAX_CONCURRENT_QUERIES=10
CLINICAL_CANVAS_COMPONENT_CACHE_TTL=3600

# ============================================================================
# OPTIONAL: EXTERNAL API KEYS
# ============================================================================
# Uncomment and add keys if using these services

# Tavily API (for AI-powered web research)
# TAVILY_API_KEY=your_tavily_api_key_here

# AWS (if using S3 storage or other AWS services)
# AWS_ACCESS_KEY_ID=your_aws_access_key
# AWS_SECRET_ACCESS_KEY=your_aws_secret_key
# AWS_REGION=us-east-1

# ============================================================================
# OPTIONAL: MONITORING (Advanced)
# ============================================================================
# Uncomment to enable monitoring features

# ENABLE_METRICS=true
# METRICS_PORT=9090
# ENABLE_TRACING=false
# JAEGER_ENDPOINT=http://localhost:14268/api/traces

# ============================================================================
# OPTIONAL: DATABASE POOL SETTINGS (Advanced)
# ============================================================================
# Tune for high-load scenarios

# DB_POOL_SIZE=20
# DB_POOL_MAX_OVERFLOW=10
# DB_POOL_TIMEOUT=30

# ============================================================================
# PRODUCTION CHECKLIST
# ============================================================================
# Before deploying to production:
#
# 1. Set ENVIRONMENT=prod
# 2. Set RESTART_POLICY=unless-stopped
# 3. Set DOMAIN to your actual domain name
# 4. Generate new SECRET_KEY and JWT_SECRET values
# 5. Update REACT_APP_* URLs to use HTTPS and your domain
# 6. Update HAPI_FHIR_SERVER_ADDRESS to your production URL
# 7. Set stronger POSTGRES_PASSWORD
# 8. Configure SSL certificates (see docs/DEPLOYMENT.md)
#
# NEVER commit .env to version control!
# ============================================================================
